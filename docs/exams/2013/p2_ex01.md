---
id: ex-2013-02
year: 2013
exam: parcial 2
tags:
 - android
---
Se desea desarrollar una aplicación que facilite la selección de un vino, ofreciéndonos información de los vinos más populares. La pantalla inicial muestra una lista de vinos, y está gestionada por una actividad denominada ```ListaVinosActivity```.  Al pinchar en el nombre de un vino se muestra otra pantalla con los detalles correspondientes. Esta pantalla está gestionada por la actividad ```DetalleVinoActivity```.

![](./p2/p2_ex1_vinos.png)

Se proporcionan las clases Vino y Bodega tal y como se detallan a continuación. 

```java
public class Vino {
    enum Denominacion { RIOJA, RIBERA, PENEDES; }
    private String nombre;
    private Denominacion denominacion;
    private int foto;
    private String descripcion;
    // suponga que tiene métodos métodos get/put para todos los campos
    // suponga que tiene un método toString() que imprime el nombre del vino
}

public class Bodega {
    public Vino getVino(String nombre) {... }
    public List<Vino> getListaVinos() {...}
    public static Bodega getBodega(){...}
}

// ejemplo de uso de las clases anteriores

public class Ejemplo {

    public static void main(String [] args) {
        Bodega bodega = Bodega.getBodega(); // creo la bodega
        List<Vino> vinos = bodega.getListaVinos(); // lista de vinos
        Vino vino = vinos.get(0); // obtener vino  recorriendo lista
        // vino dado el nombre del vino
        Vino valdehermoso = bodega.getVino("Valdehermoso"); 
    }
}
```

Se pide:

- (a) (5 puntos) Programe ```ListaVinosActivity```. Suponga que dispone de la plantilla (*layout*) correspondiente en un fichero *lista_vinos.xml*, y utilice los nombres que necesite como crea oportuno. Utilice un ```ArrayAdapter``` para mostrar los elementos de la lista.

Cuando se pulse en un elemento de la lista (el nombre de un vino), la actividad ```ListaVinosActivity``` debe lanzar la actividad ```DetalleVinoActivity``` pasándole el nombre del vino en la clave *NOMBRE*, y sin esperar un resultado de vuelta de dicha actividad.

La actividad debe mostrar una traza (Log) de tipo informativo (`I`)  con el número de vinos cargados, y una traza de tipo depuración (`D`) con la opción que ha pulsado, como se muestra a continuación.

![](./p2/p2_ex1_lista.png)

??? note "Mostrar solución"
    ```java
    public class ListaVinosActivity extends ListActivity {
       public static final String NOMBRE = "nombre";
       private static final String TAG = ListaVinosActivity.class.getSimpleName();
       private Bodega bodega;
       @Override
       protected void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.lista_vinos);
          bodega = Bodega.getBodega();
          List<Vino> lista = bodega.getListaVinos(); 
          Log.i(TAG, "Cargando " + lista.size() + " vinos"); 
          setListAdapter(new ArrayAdapter<Vino>(this,
                           android.R.layout.simple_list_item_1, lista));
       }
       @Override
       protected void onListItemClick(ListView l, View v, int position, long id) { 
          super.onListItemClick(l, v, position, id);
          Intent intent = new Intent(this, DetalleVinoActivity.class);
          Vino vino = bodega.getListaVinos().get(position);
          Log.d(TAG, "Pulsado en " + vino);
          intent.putExtra(NOMBRE, vino.getNombre());
          startActivity(intent);
       }
    }
    ```

- (b) (5 puntos) Programe ```DetalleVinoActivity```. Suponga que la plantilla *detalle_vino.xml* muestra los campos de un 
objeto ```Vino``` en los siguientes componentes: 

    - Foto en un ```ImageView``` (*R.id.foto*),
    - Nombre, denominación y descripción en tres ```EditText``` (*R.id.nombre*, *R.id.denominacion*, *R.id.descripcion*).

La actividad recibe en la intención el nombre del vino en la clave NOMBRE. Debe crear un objeto ```Bodega``` y recuperar el objeto ```Vino``` correspondiente al nombre recibido. A continuación, rellene los campos de la pantalla con los valores del vino. Puede suponer que todos los campos de un objeto ```Vino``` tienen un valor correcto.

??? note "Mostrar solución"
    ```java
    public class DetalleVinoActivity extends Activity {
       private EditText nombre;
       private EditText denominacion;
       private EditText descripcion;
       private ImageView foto;
       private static final String TAG = DetalleVinoActivity.class.getSimpleName();
    
       @Override
       protected void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.detalle_vino);
          Intent intent = getIntent();
          String nombreVino = intent.getStringExtra(ListaVinosActivity.NOMBRE);
          Bodega bodega = Bodega.getBodega();
          Vino vino = bodega.getVino(nombreVino);
          nombre = (EditText) findViewById(R.id.nombre); 
          nombre.setText(vino.getNombre());
          denominacion = (EditText) findViewById(R.id.denominacion);
          denominacion.setText(vino.getDenominacion().toString());
          descripcion = (EditText) findViewById(R.id.descripcion);
          descripcion.setText(vino.getDescripcion());
          foto = (ImageView) findViewById(R.id.foto); 
          foto.setImageResource(vino.getFoto());
       }
    }
    ```
